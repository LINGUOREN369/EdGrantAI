Synonyms Files — Structure and Guidelines

Purpose
- Improve recall by mapping common phrase variants directly to canonical tags before any embedding calls.
- Keep precision by using multi-word, unambiguous synonyms and preserving guardrails.

Where
- Directory: data/taxonomy/synonyms/
- Files loaded per taxonomy: any JSON named <taxonomy>_synonyms*.json (manual or auto).

Supported formats
1) Flat map (synonym → canonical)
{
  "ai tutoring": "AI-powered tutoring",
  "teacher pd": "teacher professional development"
}

2) Grouped by canonical tag
{
  "AI-powered tutoring": {
    "synonyms": ["ai tutoring", "intelligent tutoring systems", "ai tutor"]
  },
  "teacher professional development": {
    "synonyms": ["teacher pd", "teacher training", "pd workshops"]
  }
}

3) List form
[
  {"canonical": "AI-powered tutoring", "synonyms": ["ai tutoring", "intelligent tutoring systems"]},
  {"canonical": "teacher professional development", "synonyms": ["teacher pd", "teacher training"]}
]

Manual vs Auto
- Manual: <taxonomy>_synonyms.json or <taxonomy>_synonyms.manual.json (human-curated, domain-specific)
- Auto:   <taxonomy>_synonyms.auto.json (generated by the build_synonyms script; safe format-level variants). These are merged into the curated file by the build and then removed.

Precedence
- Runtime loader uses curated files only (auto files are ignored by default).
- The build merges auto into curated beforehand with manual precedence.

Guidelines
- Prefer multi-word, unambiguous phrases; avoid single-word generics.
- Add synonyms in manual files when you see real misses in outputs.
- Let the auto file cover format variants (acronyms, K–12 forms, and/& swaps, singular/plural).
- Do not include the canonical tag itself in the synonyms list.

Generation
- make synonyms-build →
  1) python -m pipeline.build_synonyms --all --max 12
  2) python -m pipeline.merge_auto_synonyms --all --delete-auto

Tips
- Keep curated files focused on domain phrases; let auto cover mechanical variants.
- If you want to ignore auto files temporarily, delete or rename the *.auto.json files, or remove them from source control.
